---
title: "Accessibilité aux personnes en handicapées"
author: "Philéas Condemine"
date: "05/06/2021"
output: ioslides_presentation
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

```{r packages, message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}
library(data.table)
library(plotly)
```

```{r data-loading, message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}
handicap = fread("../data/data-es.csv",encoding = "UTF-8")
```

```{r functions, message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}
count_and_plot = function(data,var){
  stats = data[,.N,by=var]
  setnames(stats,var,"x")
  setorder(stats,-N)
  stats[,x:=factor(x)]
  stats[,x:=forcats::fct_inorder(x)]
  plot_ly(data=stats,x=~x,y=~N)
}
show_pct = function(x)paste0(round(100*x,1),"%")

```


<style type="text/css">
.lang-small_size {  
  font-size: 12px;
}
</style>



## Accessibilité aux personnes en situation de handicap

Scorer et classifier les établissements pouvant accueillir les personnes en situations de handicap


## Hypothèses

- Il ne s'agit pas d'un projet juridique, l'objectif n'est donc pas d'étudier le cadre juridique des normes d'accessibilité en France.
- On se propose pas la suite de comparer les établissements en termes d'accessibilité afin de permettre d'identifier les établissements défaillants.

## Diversité des établissements 

```{r distr familles, message=FALSE, warning=FALSE, paged.print=FALSE}
# handicap[,.N,by=.(`Type d'équipement sportif`)]
count_and_plot(handicap,"Famille d'équipement sportif")%>%plotly::layout(title="Distribution des établissements par famille d'équipement sportif")
```

## Indicateurs d'accessibilité

On se concentre sur le premier indicateur (99% !NA & 65% OK).

```{r message=FALSE, warning=FALSE, paged.print=FALSE}
nm = names(handicap)
# grep("access",nm,value=T,ignore.case = T)
# grep("handicap",nm,value=T,ignore.case = T)
vars = grep("(handicap)|(access)",nm,value=T,ignore.case = T)


stats_var_handicap_access = handicap[, c(.(stat = c("not_na","avg","min","max","nb_mod")),lapply(.SD, function(x)
  c(
    not_na = show_pct(mean(!is.na(x))),
    avg = show_pct(mean(x, na.rm = T)),
    min = min(x, na.rm = T),
    max = max(x, na.rm = T),
    nb_mod = uniqueN(x)
  ))), .SDcols = vars]

DT::datatable(stats_var_handicap_access, 
              extensions = 'FixedColumns',
  options = list(
    dom = 't',
    scrollX = TRUE,
    fixedColumns = TRUE
  ),
  rownames = F
  )

```


## Accessibilité par famille d'établissement

```{r}
setnames(handicap,"Accessibilité de l'installation en faveur des personnes en situation de handicap","target")
```

